{"_path":"/dodock/installation/docker","_dir":"installation","_draft":false,"_partial":false,"_locale":"fr","title":"Installation Docker","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"installation-de-dokos-avec-docker"},"children":[{"type":"text","value":"Installation de Dokos avec Docker"}]},{"type":"element","tag":"h2","props":{"id":"pré-requis"},"children":[{"type":"text","value":"Pré-requis"}]},{"type":"element","tag":"h3","props":{"id":"installer-docker"},"children":[{"type":"text","value":"Installer Docker"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si Docker et Docker Compose ne sont pas installés sur votre serveur, vous pouvez utiliser la commande suivante ou vous reporter à la documentation de Docker."}]},{"type":"element","tag":"pre","props":{"code":"curl -fsSL https://get.docker.com | bash\n\n# Vérifier l'installation de Docker\ndocker --version\ndocker compose version\ndocker run hello-world\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -fsSL"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" https://get.docker.com"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":" bash\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Vérifier l'installation de Docker\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" hello-world\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"télécharger-le-fichier-compose-pour-dokos"},"children":[{"type":"text","value":"Télécharger le fichier Compose pour Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Téléchargez le fichier "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"compose.yaml"}]},{"type":"text","value":" pour Dokos depuis le dépôt GitLab de Docli ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench"}]},{"type":"text","value":" comme nous le verrons plus tard).\nPar défaut, la version de Dokos utilisée est la dernière version stable, disponible avec le tag "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"latest"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"curl -o compose.yaml https://gitlab.com/dokos/docli/-/raw/develop/compose/dokos.yaml\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -o"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose.yaml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" https://gitlab.com/dokos/docli/-/raw/develop/compose/dokos.yaml\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"lancer-dokos"},"children":[{"type":"text","value":"Lancer Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Vous pouvez ensuite lancer le conteneur de Dokos avec :"}]},{"type":"element","tag":"pre","props":{"code":"docker compose up -d\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" up"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -d\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La création du site peut prendre quelques minutes. Pendant cette étape, le site ne sera pas actif et donc indisponible dans votre navigateur."}]},{"type":"element","tag":"h2","props":{"id":"accéder-à-dokos"},"children":[{"type":"text","value":"Accéder à Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Vous pouvez accéder à Dokos en accédant au port 8080 du serveur dans votre navigateur, par exemple "},{"type":"element","tag":"a","props":{"href":"http://localhost:8080","rel":["nofollow"]},"children":[{"type":"text","value":"http://localhost:8080"}]},{"type":"text","value":" si le conteneur tourne sur votre ordinateur."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ensuite, vous pouvez vous connecter avec les identifiants suivants :"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nom d'utilisateur : "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Administrator"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Mot de passe : "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"admin"}]}]}]},{"type":"element","tag":"callout","props":{"color":"amber","icon":"i-heroicons-exclamation-triangle"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"N'oubliez pas de changer le mot de passe de l'utilisateur "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Administrator"}]},{"type":"text","value":" après la finalisation de l'installation.\nPour changer le mot de passe d'administration, cliquez sur l'avatar (cercle coloré en haut tout à droite), puis cliquez sur l'option Mes Paramètres.\nCliquez sur l'onglet Paramètres, puis ouvrez la section Modification de mot de passe, dans laquelle vous pourrez changer le mot de passe."}]}]},{"type":"element","tag":"h2","props":{"id":"arrêter-dokos"},"children":[{"type":"text","value":"Arrêter Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour arrêter Dokos, vous pouvez utiliser la commande suivante :"}]},{"type":"element","tag":"pre","props":{"code":"docker compose down\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" down\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"configurer-son-nom-de-domaine"},"children":[{"type":"text","value":"Configurer son nom de domaine"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour accéder à Dokos via votre nom de domaine (ex. "},{"type":"element","tag":"a","props":{"href":"https://demo.dokos.cloud","rel":["nofollow"]},"children":[{"type":"text","value":"https://demo.dokos.cloud"}]},{"type":"text","value":"), il va falloir installer les éléments suivants sur votre serveur:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Nginx"}]},{"type":"text","value":": Reverse proxy permettant de rediriger votre nom de domaine vers le port 8080 de votre serveur"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Certbot"}]},{"type":"text","value":": Utilitaire permettant de créer un certificat SSL pour une connexion sécurisée"}]}]},{"type":"element","tag":"callout","props":{"color":"teal","icon":"i-heroicons-light-bulb"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La configuration présentée ici est simple et a pour but de vous permettre de déployer facilement un site Dokos."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nNous vous recommandons de renforcer cette configuration avec toutes les mesures de sécurité qui vous semblent appropriées."}]}]},{"type":"element","tag":"h3","props":{"id":"_1-effectuer-une-redirection-dns"},"children":[{"type":"text","value":"1. Effectuer une redirection DNS"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La première étape consiste à aller dans les paramètres DNS de votre nom de domaine et à ajouter une entrée de redirection A vers le serveur sur lequel vous avez installé Dokos."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ex. demo.dokos.cloud | A | 15.237.107.35"}]},{"type":"element","tag":"h3","props":{"id":"_2-installation-de-nginx"},"children":[{"type":"text","value":"2. Installation de Nginx"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sur Ubuntu, l'installation de Nginx se fait avec la commande suivante:\n"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo apt install nginx"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Une foix Nginx installé, créez un fichier de configuration pour votre site dans le dossier "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/nginx/sites-enabled/"}]},{"type":"text","value":":"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo nano /etc/nginx/sites-enabled/demo.conf"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ajoutez-y une redirection vers le port 8080 dans ce fichier et enregistrez le:"}]},{"type":"element","tag":"pre","props":{"code":"server {\n    server_name demo.dokos.cloud; # A remplacer par votre nom de domaine\n\n    location / {\n        proxy_set_header   X-Forwarded-For $remote_addr;\n        proxy_set_header   Host $http_host;\n        proxy_pass         http://127.0.0.1:8080;\n    }\n}\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"server {\n    server_name demo.dokos.cloud; # A remplacer par votre nom de domaine\n\n    location / {\n        proxy_set_header   X-Forwarded-For $remote_addr;\n        proxy_set_header   Host $http_host;\n        proxy_pass         http://127.0.0.1:8080;\n    }\n}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Redémarrez Nginx et connectez-vous à l'adresse "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"demo.dokos.cloud"}]},{"type":"text","value":" pour vérifier que la redirection fonctionne bien."}]},{"type":"element","tag":"pre","props":{"code":"sudo nginx -t\nsudo systemctl reload nginx\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo nginx -t\nsudo systemctl reload nginx\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_3-création-dun-certificat"},"children":[{"type":"text","value":"3. Création d'un certificat"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Installez certbot ("},{"type":"element","tag":"a","props":{"href":"https://certbot.eff.org/","rel":["nofollow"]},"children":[{"type":"text","value":"https://certbot.eff.org/"}]},{"type":"text","value":") sur votre système."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nPour Ubuntu:"}]},{"type":"element","tag":"pre","props":{"code":"sudo snap install --classic certbot\nsudo ln -s /snap/bin/certbot /usr/bin/certbot\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" snap"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --classic"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" certbot\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" ln"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -s"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /snap/bin/certbot"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /usr/bin/certbot\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lancez certbot pour générer un certificat: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sudo certbot --nginx"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Rechargez la page de votre site (ex. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"demo.dokos.cloud"}]},{"type":"text","value":"), vous pourrez constater que votre certificat est actif."}]},{"type":"element","tag":"h2","props":{"id":"sauvegarder-restaurer-mettre-à-jour"},"children":[{"type":"text","value":"Sauvegarder, restaurer, mettre à jour"}]},{"type":"element","tag":"h3","props":{"id":"sauvegarder-dokos"},"children":[{"type":"text","value":"Sauvegarder Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour sauvegarder Dokos "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"une fois lancé"}]},{"type":"text","value":", vous pouvez utiliser la commande suivante :"}]},{"type":"element","tag":"pre","props":{"code":"# Le système doit être up pour effectuer une sauvegarde\ndocker compose run backend bench backup --with-files --compress\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Le système doit être up pour effectuer une sauvegarde\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" backend"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" bench"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" backup"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --with-files"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --compress\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si vous souhaitez récupérer ces sauvegardes depuis l'extérieur du conteneur, vous avez plusieurs possibilités :"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Utiliser "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"docker cp"}]},{"type":"text","value":" pour copier les fichiers depuis le conteneur vers votre machine.\n"},{"type":"element","tag":"pre","props":{"code":"docker cp dokos-backend-1:/home/frappe/frappe-bench/sites/frontend/private/backups/ ./dokos-backups\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" cp"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" dokos-backend-1:/home/frappe/frappe-bench/sites/frontend/private/backups/"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" ./dokos-backups\n"}]}]}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Utiliser "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"docker run"}]},{"type":"text","value":" pour dupliquer les volumes "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"db-data"}]},{"type":"text","value":" et "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sites"}]},{"type":"text","value":".\n"},{"type":"element","tag":"a","props":{"href":"https://docs.docker.com/storage/volumes/#back-up-restore-or-migrate-data-volumes","rel":["nofollow"]},"children":[{"type":"text","value":"https://docs.docker.com/storage/volumes/#back-up-restore-or-migrate-data-volumes"}]}]}]},{"type":"element","tag":"h3","props":{"id":"restaurer-dokos"},"children":[{"type":"text","value":"Restaurer Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour restaurer Dokos, vous devez d'abord démarrer le système et suivre cette procédure :"}]},{"type":"element","tag":"pre","props":{"code":"# Le projet dokos doit être up pour effectuer une restauration\ndocker compose up -d\n\n# Lister les sauvegardes disponibles\ndocker compose run backend ls sites/frontend/private/backups\n\n# Restaurer la sauvegarde en spécifiant le nom du fichier\ndocker compose run backend bench restore \\\n    [...]-frontend-database.sql.gz \\\n    --with-public-files [...]-frontend-files.tar.gz \\\n    --with-private-files [...]-frontend-private-files.tar.gz\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Le projet dokos doit être up pour effectuer une restauration\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" up"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -d\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Lister les sauvegardes disponibles\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" backend"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" ls"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" sites/frontend/private/backups\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Restaurer la sauvegarde en spécifiant le nom du fichier\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" backend"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" bench"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" restore"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8"},"children":[{"type":"text","value":"    [...]-frontend-database.sql.gz \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"    --with-public-files"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" [...]-frontend-files.tar.gz \\\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"    --with-private-files"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8"},"children":[{"type":"text","value":" [...]-frontend-private-files.tar.gz\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"mettre-à-jour-dokos"},"children":[{"type":"text","value":"Mettre à jour Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour mettre à jour Dokos, vous pouvez utiliser la commande suivante :"}]},{"type":"element","tag":"pre","props":{"code":"# Modifiez le numéro de version dans le fichier compose.yaml si besoin\n\n# Télécharger les nouvelles images Docker\ndocker compose pull\n\n# Relancer les conteneurs\ndocker compose down\ndocker compose up -d\n\n# Migrer les sites\ndocker compose run backend bench --site all migrate\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Modifiez le numéro de version dans le fichier compose.yaml si besoin\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Télécharger les nouvelles images Docker\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" pull\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Relancer les conteneurs\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" down\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" up"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -d\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#90A4AE;--shiki-default:#546E7A;--shiki-dark:#676E95;--shiki-light-font-style:italic;--shiki-default-font-style:italic;--shiki-dark-font-style:italic"},"children":[{"type":"text","value":"# Migrer les sites\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docker"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" compose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" backend"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" bench"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --site"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" all"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" migrate\n"}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"résolution-de-problèmes"},"children":[{"type":"text","value":"Résolution de problèmes"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"La page du bureau est vide après une mise à jour : il faut toujours démonter les conteneurs avec la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"docker compose down"}]},{"type":"text","value":" après une mise à jour."}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"pré-requis","depth":2,"text":"Pré-requis","children":[{"id":"installer-docker","depth":3,"text":"Installer Docker"},{"id":"télécharger-le-fichier-compose-pour-dokos","depth":3,"text":"Télécharger le fichier Compose pour Dokos"}]},{"id":"lancer-dokos","depth":2,"text":"Lancer Dokos"},{"id":"accéder-à-dokos","depth":2,"text":"Accéder à Dokos"},{"id":"arrêter-dokos","depth":2,"text":"Arrêter Dokos"},{"id":"configurer-son-nom-de-domaine","depth":2,"text":"Configurer son nom de domaine","children":[{"id":"_1-effectuer-une-redirection-dns","depth":3,"text":"1. Effectuer une redirection DNS"},{"id":"_2-installation-de-nginx","depth":3,"text":"2. Installation de Nginx"},{"id":"_3-création-dun-certificat","depth":3,"text":"3. Création d'un certificat"}]},{"id":"sauvegarder-restaurer-mettre-à-jour","depth":2,"text":"Sauvegarder, restaurer, mettre à jour","children":[{"id":"sauvegarder-dokos","depth":3,"text":"Sauvegarder Dokos"},{"id":"restaurer-dokos","depth":3,"text":"Restaurer Dokos"},{"id":"mettre-à-jour-dokos","depth":3,"text":"Mettre à jour Dokos"},{"id":"résolution-de-problèmes","depth":3,"text":"Résolution de problèmes"}]}]}},"_type":"markdown","_id":"content:3.dodock:11.installation:2.docker.md","_source":"content","_file":"3.dodock/11.installation/2.docker.md","_extension":"md"}