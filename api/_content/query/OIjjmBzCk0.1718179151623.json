{"_path":"/dodock/administration/migration-v4","_dir":"administration","_draft":false,"_partial":false,"_locale":"fr","title":"Migrer vers la version 4 de Dokos","description":"Si vous utilisez Dokos v3 en auto-h√©bergement, certaines √©tapes sont requises avant de mettre √† jour votre installation vers la version 3 de Dokos.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"migrer-vers-la-version-4-de-dokos"},"children":[{"type":"text","value":"Migrer vers la version 4 de Dokos"}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si vous souhaitez "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"installer"}]},{"type":"text","value":" Dokos pour la premi√®re fois, consultez le "},{"type":"element","tag":"a","props":{"href":"/dodock/installation"},"children":[{"type":"text","value":"guide d'installation rapide"}]},{"type":"text","value":" plut√¥t que ce guide de migration."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"La version 4 de Dokos n√©cessite Python 3.10 ou Python 3.11 et NodeJS 18 pour fonctionner."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nSi vous avez pr√©c√©demment install√© "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Dokos v3"}]},{"type":"text","value":", une mise √† jour de certains paquets logiciels et une migration du dossier bench est n√©cessaire avant d'installer Dokos v4."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"üìÑ Ce guide est destin√© aux installations de Dokos auto-h√©berg√©es sous Ubuntu."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"pr√©requis-node-18-python-310"},"children":[{"type":"text","value":"Pr√©requis (Node 18, Python 3.10)"}]},{"type":"element","tag":"h3","props":{"id":"installer-nodejs-18"},"children":[{"type":"text","value":"Installer NodeJS 18"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour installer NodeJS 18 sur Ubuntu, vous pouvez utiliser le gestionnaire de versions "},{"type":"element","tag":"a","props":{"href":"https://github.com/nvm-sh/nvm","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nvm"}]}]},{"type":"text","value":", ou alternativement utiliser les commandes suivantes :"}]},{"type":"element","tag":"pre","props":{"code":"wget -qO- https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt install -y nodejs\nnode --version\n","language":"sh","meta":"","className":"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"wget"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -qO-"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" https://deb.nodesource.com/setup_18.x"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":" sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -E"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" bash"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" apt"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -y"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" nodejs\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"node"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Puis v√©rifiez l'installation avec "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"node --version"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"installer-python-310"},"children":[{"type":"text","value":"Installer Python 3.10"}]},{"type":"element","tag":"callout","props":{"color":"amber","icon":"i-heroicons-exclamation-triangle"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Il faut installer Python 3.10 "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"sans remplacer"}]},{"type":"text","value":" la version de Python install√©e par d√©faut avec Ubuntu, car cela pourrait interf√©rer avec le fonctionnement de certains outils comme "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apt"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour installer Python 3.10 sur Ubuntu, il est recommand√© d'utiliser le paquet "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"deadsnakes/ppa"}]},{"type":"text","value":". L'installation peut s'effectuer comme ci-dessous :"}]},{"type":"element","tag":"pre","props":{"code":"sudo add-apt-repository ppa:deadsnakes/ppa\n\nsudo apt-get update\n\nsudo apt-get install python3.10\nsudo apt-get install python3.10-dev\nsudo apt-get install python3.10-distutils\n\nsudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.10 1\n\nsudo update-alternatives --config python3\n\npython3 -V\n","language":"sh","meta":"","className":"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" add-apt-repository"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" ppa:deadsnakes/ppa\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" update\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3.10\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3.10-dev\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" apt-get"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3.10-distutils\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" update-alternatives"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /usr/bin/python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /usr/bin/python3.10"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":" 1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"sudo"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" update-alternatives"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --config"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -V\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Vous pouvez v√©rifier que Python 3.10 est install√© avec "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python3 -V"}]},{"type":"text","value":", avant de poursuivre comme suit :"}]},{"type":"element","tag":"pre","props":{"code":"curl -sS https://bootstrap.pypa.io/get-pip.py | python3.10\n\npip install dokos-cli --upgrade\n","language":"sh","meta":"","className":"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"curl"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" -sS"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" https://bootstrap.pypa.io/get-pip.py"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":" |"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":" python3.10\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"pip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" dokos-cli"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --upgrade\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"finaliser-la-migration"},"children":[{"type":"text","value":"Finaliser la migration"}]},{"type":"element","tag":"h3","props":{"id":"migration-de-lenvironnement-virtuel-de-votre-bench"},"children":[{"type":"text","value":"Migration de l'environnement virtuel de votre bench"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Une fois Python 3.10 et Node 18 correctement install√©s, vous pouvez poursuivre avec la migration du dossier de bench vers la nouvelle version de Python."}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si votre "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench"}]},{"type":"text","value":" est d√©j√† sous Python 3.10, vous pouvez passer cette √©tape.."}]}]},{"type":"element","tag":"pre","props":{"code":"bench migrate-env python3.10\n","language":"sh","meta":"","className":"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"bench"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" migrate-env"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" python3.10\n"}]}]}]}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Chaque bench est un environnement virtuel Python s√©par√© des autres environnements virtuels. Seul "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"dokos-cli"}]},{"type":"text","value":" utilise la version de Python par d√©faut du syst√®me."}]}]},{"type":"element","tag":"h3","props":{"id":"ajout-des-nouvelles-applications"},"children":[{"type":"text","value":"Ajout des nouvelles applications"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Certains modules de Dokos sont d√©sormais publi√©s dans des modules s√©par√©s. Si vous utilisez certaines de leurs fonctionnalit√©s, commencez par les ajouter dans votre bench."}]},{"type":"element","tag":"h4","props":{"id":"webhsop"},"children":[{"type":"text","value":"Webhsop"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Cette application est √† installer uniquement si vous utilisez les fonctionnalit√©s eCommerce de Dokos."}]},{"type":"element","tag":"pre","props":{"code":"bench get-app https://gitlab.com/dokos/webshop --branch v4\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"bench get-app https://gitlab.com/dokos/webshop --branch v4\n"}]}]},{"type":"element","tag":"h3","props":{"id":"mont√©e-de-version-de-dodockdokos"},"children":[{"type":"text","value":"Mont√©e de version de Dodock/Dokos"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Apr√®s la r√©cup√©ration des nouvelles applications, changez de branche pour passer sur la version 4 de Dodock/Dokos."}]},{"type":"element","tag":"pre","props":{"code":"bench switch-to-branch v4 frappe erpnext hrms payments --upgrade\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"bench switch-to-branch v4 frappe erpnext hrms payments --upgrade\n"}]}]},{"type":"element","tag":"h3","props":{"id":"installation-des-nouvelles-applications-sur-votre-site"},"children":[{"type":"text","value":"Installation des nouvelles applications sur votre site"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Installez les nouvelles applications sur votre site"}]},{"type":"element","tag":"pre","props":{"code":"bench install-app webshop\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"bench install-app webshop\n"}]}]},{"type":"element","tag":"h3","props":{"id":"relancez-une-mise-√†-jour"},"children":[{"type":"text","value":"Relancez une mise √† jour"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enfin, "},{"type":"element","tag":"a","props":{"href":"/dodock/administration/mises-a-jour"},"children":[{"type":"text","value":"mettez √† jour Dokos/Dodock"}]},{"type":"text","value":" normalement."}]},{"type":"element","tag":"pre","props":{"code":"bench update --reset\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"bench update --reset\n"}]}]},{"type":"element","tag":"callout","props":{"color":"green"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si l'installation s'est pass√©e correctement, vous pouvez d√©sormais profiter des "},{"type":"element","tag":"a","props":{"href":"/dodock/versions/v4.x.x/v4_0_0"},"children":[{"type":"text","value":"nouvelles fonctionnalit√©s de Dokos v4"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"br","props":{},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"d√©pannage"},"children":[{"type":"text","value":"D√©pannage"}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"V√©rifiez que les paquets pr√©requis sont correctement install√©s avec les commandes suivantes :"}]},{"type":"element","tag":"pre","props":{"code":"python3 --version\npip --version\nnode --version\nyarn --version\ndocli --version / bench --version\n","language":"sh","meta":"","className":"language-sh shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"python3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"pip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"node"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"yarn"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B"},"children":[{"type":"text","value":"docli"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" /"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" bench"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D"},"children":[{"type":"text","value":" --version\n"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"la-migration-du-bench-√©choue"},"children":[{"type":"text","value":"La migration du bench √©choue"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si les pr√©requis sont correctement install√©s, il est normalement possible de migrer un bench d'une version de Python √† une autre avec la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench migrate-env python3.10"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si jamais cela ne fonctionne pas, il peut √™tre plus simple de cr√©er un nouveau bench puis d'y d√©placer un site depuis l'ancien bench."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tout d'abord, cr√©ez un nouveau bench sous Python 3.10 avec la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench init bench-nouveau --python python3.10"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"D√©placez-y le dossier contenant votre site dans ce nouveau bench "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"mv ~/bench-ancien/sites/mon_site ~/bench-nouveau/sites/"}]},{"type":"text","value":", puis ex√©cutez la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench setup production {votre utilisateur} && bench update"}]},{"type":"text","value":" dans le nouveau bench."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Vous aurez peut-√™tre besoin d'installer de nouveau les applications tierces que vous avez pu installer. Vous pouvez consulter la liste de ces applications avec la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cat ~/bench-ancien/sites/apps.txt"}]},{"type":"text","value":"."}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour toute question ou demande d'aide, vous pouvez vous rendre sur le "},{"type":"element","tag":"a","props":{"href":"https://community.dokos.io","rel":["nofollow"]},"children":[{"type":"text","value":"forum de la communaut√©"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"h3","props":{"id":"pythonapt-get-ne-fonctionne-plus"},"children":[{"type":"text","value":"Python/"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apt-get"}]},{"type":"text","value":" ne fonctionne plus"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si jamais votre installation globale de Python (Python 3.4 sous Ubuntu 18) ne fonctionne plus, vous pouvez r√©installer la version syst√®me de Python en suivant ce lien :\n"},{"type":"element","tag":"a","props":{"href":"https://askubuntu.com/questions/1196401/how-to-fix-python3-after-messing-it-up/1200793#1200793","rel":["nofollow"]},"children":[{"type":"text","value":"https://askubuntu.com/questions/1196401/how-to-fix-python3-after-messing-it-up/1200793#1200793"}]}]},{"type":"element","tag":"h3","props":{"id":"modulenotfounderror-no-module-named-virtualenv"},"children":[{"type":"text","value":"ModuleNotFoundError: No module named "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"virtualenv"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si cette erreur se produit, il suffit de reinstaller "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"virtualenv"}]},{"type":"text","value":" avec la commande "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pip install virtualenv"}]},{"type":"text","value":"."}]},{"type":"element","tag":"callout","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Si vous rencontrez trop de difficult√©s √† migrer votre bench existant, n'h√©sitez pas √† cr√©er un nouveau bench sous python3.10, √† couper/copier le dossier contenant les √©l√©ments de votre site dans ce nouveau bench et √† lancer la mise √† jour dans ce nouveau bench."}]}]},{"type":"element","tag":"callout","props":{"color":"amber","icon":"i-heroicons-exclamation-triangle"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"N'oubliez jamais de "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"sauvegarder"}]},{"type":"text","value":" avant d'effectuer n'importe quelle op√©ration de migration."}]}]},{"type":"element","tag":"h3","props":{"id":"activer-les-scripts-serveur-si-besoin"},"children":[{"type":"text","value":"Activer les scripts serveur si besoin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Pour des raisons de s√©curit√©, les scripts serveur sont maintenant d√©sactiv√©s par d√©faut. Pour les activer, il faut configurer la cl√© "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"server_script_enabled"}]},{"type":"text","value":" dans les param√®tres du bench avec "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"bench set-config -g server_script_enabled 1"}]},{"type":"text","value":". Il n'est pas possible d'activer les scripts serveur au niveau d'un site."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"pr√©requis-node-18-python-310","depth":2,"text":"Pr√©requis (Node 18, Python 3.10)","children":[{"id":"installer-nodejs-18","depth":3,"text":"Installer NodeJS 18"},{"id":"installer-python-310","depth":3,"text":"Installer Python 3.10"}]},{"id":"finaliser-la-migration","depth":2,"text":"Finaliser la migration","children":[{"id":"migration-de-lenvironnement-virtuel-de-votre-bench","depth":3,"text":"Migration de l'environnement virtuel de votre bench"},{"id":"ajout-des-nouvelles-applications","depth":3,"text":"Ajout des nouvelles applications"},{"id":"mont√©e-de-version-de-dodockdokos","depth":3,"text":"Mont√©e de version de Dodock/Dokos"},{"id":"installation-des-nouvelles-applications-sur-votre-site","depth":3,"text":"Installation des nouvelles applications sur votre site"},{"id":"relancez-une-mise-√†-jour","depth":3,"text":"Relancez une mise √† jour"}]},{"id":"d√©pannage","depth":2,"text":"D√©pannage","children":[{"id":"la-migration-du-bench-√©choue","depth":3,"text":"La migration du bench √©choue"},{"id":"pythonapt-get-ne-fonctionne-plus","depth":3,"text":"Python/apt-get ne fonctionne plus"},{"id":"modulenotfounderror-no-module-named-virtualenv","depth":3,"text":"ModuleNotFoundError: No module named virtualenv"},{"id":"activer-les-scripts-serveur-si-besoin","depth":3,"text":"Activer les scripts serveur si besoin"}]}]}},"_type":"markdown","_id":"content:3.dodock:12.administration:8.migration-v4.md","_source":"content","_file":"3.dodock/12.administration/8.migration-v4.md","_extension":"md"}