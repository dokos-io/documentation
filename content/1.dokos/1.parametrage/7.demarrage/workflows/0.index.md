---
title: Flux de travail
---

Avec les Flux de travail, vous pouvez réécrire comment un processus / flux de travail est approuvé dans DOKOS.

La création d'un flux de travail permet de définir et de personnaliser les étapes nécessaires à l'approbation ou au rejet d'un document. Ce flux de travail remplace le flux par défaut de Dokos.

Pour accéder à **la liste de flux de travail**, allez sur :

> Accueil > Paramètres > **Flux de travail**

::tour{demo="Mappemonde" doctype="workflow"}
Créer un flux de travail dans la démo
::

**Les notes de frais et les demandes de congés** sont les seuls formulaires qui nécessitent obligatoirement un approbateur et qui ont un flux d'approbation par défaut. Le flux de travail personnalisé remplacera ce flux par défaut. Il est possible de créer des flux de travail pour tous les documents présents dans Dokos.

Vous pouvez utiliser l'éditeur de flux de travail pour créer des flux de travail de manière visuelle. Cet outil permet de glisser-déposer des états et de les relier entre eux pour établir des transitions. Vous pouvez également modifier leurs propriétés à partir de la barre latérale.

Lorsque vous enregistrez votre schéma, les champs du formulaire en tableau se remplissent automatiquement.

Voici un exemple pour la validation des dépenses avec l'éditeur visuel :

![Cette image permet de visualiser le formulaire : Flux de travail.](/fluxdetravail1.png)![Cette image permet de visualiser le formulaire : Créer un flux de travail](/fluxdetravail2.png)![Cette image permet de visualiser le formulaire d'édition visuel.](/fluxdetravail3.png)

1. État :

Vous pouvez créer des états selon vos besoins.

Exemple :

- **Brouillon** : État initial de la dépense.
- **Soumis à la validation** : La dépense est soumise pour approbation.
- **Approuvé** : La dépense est approuvée.
- **Rejeté** : La dépense est rejetée.
- **Annulé** : La dépense est annulée.

2. Statut du document :

- Brouillon : Ce statut est à utiliser jusqu'à l'approbation finale.
- Soumis : Ce statut fige le document; il n'est plus modifiable.
- Annulé

![Cette image permet de visualiser les états de mon document.](/fluxdetravail4.png)

3. Autoriser la modification uniquement pour :

Vous devez sélectionner le rôle autorisé à modifier l'état. Il est nécessaire de mener une réflexion sur les différents rôles de votre organisation.

4. Mettre à jour le champ / mettre à jour la valeur :![Image permettant de visualiser la mise à jour d'un champ dans un document automatiquement.](/fluxdetravail22.png)Dans certains documents, lorsque aucun flux de travail n'est défini, l'approbateur doit modifier manuellement le statut du document. En mettant en place un flux de travail, vous devez définir le champ à mettre à jour ainsi que la valeur de mise à jour.![Cette image permet de visualiser un formulaire de note de frais avec une menu déroulant permettant de modifier le statut du document.](/fluxdetravail21.png)

![Cette image permet de visualiser une transition possible.](/fluxdetravail5bis.png)

5. Propriété de la transition : Les règles de transition déterminent comment les états changent d'un état à un autre.

Exemple : **De Brouillon à Soumis à la validation** : Action (Bouton) "Soumettre à la validation" par l'employé.

- Vous avez la possibilité de définir des conditions, ce qui peut être utile pour orienter une demande selon son montant.

Exemple : si le montant de la dépense est supérieur à 50 €, l'approbation doit être faite par l'approbateur des notes de frais, alors que si cette dépense est inférieure ou égale à 50 €, l'employé peut lui-même valider sa dépense.

Voici un exemple finalisé de flux de travail, avec la visualisation graphique et sous forme de tableau.

![Cette image permet de visualiser un flux de travail finalisé.](/fluxdetravail5.png)![Image permet de visualiser le formulaire avec les champs sous forme de tableau.](/fluxdetravail6.png)

État du flux de travail

Vous avez la possibilité d'ajouter une couleur pour représenter l'état du flux de travail.

![Cette image permet de visualiser le lien du formulaire : Etat de flux de travail](/fluxdetravail7bis.png)![Cette image permet de visualiser le formulaire sur l'état du flux de travail.](/fluxdetravail7.png)

Option; ne pas remplacer le statut.

- le statut de ce flux de travail ne remplacera pas le statut du document dans la vue de liste.

![Cette image permet de visualiser l'option pour ne pas remplacer le statut dans la vue liste.](/fluxdetravail8.png)

Dans l'exemple ci-dessous, nous avons coché l'option. C'est le statut par défaut du document qui est affiché.

![Cette image permet de visualiser le statut du document dans la vue liste.](/fluxdetravail13.png)

Dans l'exemple ci-dessous, nous n'avons pas coché l'option. C'est donc le statut créé lors de la mise en place du flux de travail qui est visible dans la vue liste de notre dépense.

![Cette image permet de visualisation le statut dans la vue liste.](/fluxdetravail12.png)

Particularité : Que l'option soit cochée ou non, le statut à l'intérieur du document reste le statut par défaut.

![Cette image permet de visualiser le statut du document avec la personnalisation de la couleur.](/fluxdetravail9.png)

Personnalisation; Obtenir les deux statuts dans la vue liste.

Ci-dessous le pas à pas pour obtenir une vue liste avec les deux statuts du document.

![Cette image permet de visualiser la première étape pour permettre d'obtenir les deux statuts dans la vue liste.](/fluxdetravail15.png)![Image permettant de visualiser la seconde étape pour obtenir les deux statuts.](/fluxdetravail16.png)![Cette image permet de visualiser la prochaine étape pour obtenir les deux statuts dans la vue liste.](/fluxdetravail17.png)![Cette image permet de visualiser la personnalisation de la vue liste.](/fluxdetravail18.png)![Cette image permet de visualiser la vue liste avec les deux statuts.](/fluxdetravail19.png)

A savoir :

Lorsque vous créez un flux de travail pour les notes de frais ou les demandes de congé, vous devez vous rendre dans les paramètre RH afin de retirer l'obligation de renseigner un approbateur dans les documents.

Avant de retirer l'i

![Cette image permet de visualiser le formulaire : Note de frais.](/fluxdetravail24bis.png)![Cette image permet de visualiser le formulaire : Paramètres RH.](/fluxdetravail23.png)![Cette image permet de visualiser la personnalisation d'un formulaire. formulaire](/fluxdetravail24.png)

les champs de la colonne Mettre à jour le champ ne sont pas mis à jour, un nouveau champ personnalisé sera créé avec le nom que vous avez défini dans le champ **Champ d'état du flux de travail**.

### 2.3 Autres options pour un flux de travail

- **Est actif** : en cochant cette case, tous les autres flux de travail pour le DocType sélectionné deviennent inactifs.
- **Ne pas remplacer le statut** : le statut de ce flux de travail ne remplacera pas le statut du document (Quitter l'application) dans la vue de liste.
- **Envoyer des alertes par e-mail** : des e-mails seront envoyés à l'utilisateur avec les prochaines actions de workflow possibles.

### 3.2 Conditions

Vous pouvez également ajouter une condition pour que la transition soit applicable. Par exemple, dans ce cas, si quelqu'un demande un congé de plus de 5 jours, un rôle particulier doit approuver. Pour que cela se produise dans la transition particulière, vous pouvez définir une propriété pour Condition sous Approuvé par les RH comme :

```text
doc.total_leave_days <= 5
```

Ensuite, si quelqu'un a demandé un congé de moins de 5 jours, seule cette transition particulière s'appliquera. Voici total\_leave\_daysle nom de champ du champ «Nombre total de jours de congé» de demande de congé. Pour voir le nom de champ d'un champ, allez dans Menu> Personnaliser.

Sur DOKOS vous pouvez utiliser date / heure, session, obtenir une valeur et obtenir des fonctions de liste dans vos expressions de condition.

**Fonctions autorisées :**

- frappe.db.get\_value
- frappe.db.get\_list
- frappe.session
- frappe.utils.now\_datetime
- frappe.utils.get\_datetime
- frappe.utils.add à ce jour
- frappe.utils.now

Exemples:

Cela peut être étendu à n'importe quelle propriété du document.

```text
doc.creation > frappe.utils.add_to_date(frappe.utils.now_datetime(), days=-5, as_string=True, as_datetime=True)
```
