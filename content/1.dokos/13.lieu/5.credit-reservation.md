---
title: Crédits de réservation
desciption : Un crédit de réservation est une unité de valeur virtuelle qui peut être utilisée par les utilisateurs pour réserver des ressources. Ces crédits fonctionnent comme une monnaie interne permettant de simplifier la reservation de ressource.s
---

## Crédits de réservation

Les crédits de réservation sont des unités de valeur prépayées que les utilisateurs peuvent utiliser pour effectuer des réservations au sein de l'entreprise. Ils sont particulièrement utiles pour les tiers-lieux, comme les espaces de coworking, où les membres peuvent acheter des crédits et les utiliser pour réserver des espaces ou des services.

Cette fonctionnalité a été pensée pour permettre les achats d'heures de location de salles et/ou d'espace de coworking et le décompte de ces heures a posteriori.  

**Avantages des crédits de réservation**
- Flexibilité : Permet aux utilisateurs de réserver des services selon leurs besoins sans devoir payer à chaque fois.
- Gestion Simplifiée : Facilite la gestion des réservations et des paiements, tant pour les utilisateurs que pour les gestionnaires du lieu.
- Fidélisation des Clients : Encourage les utilisateurs à revenir et à utiliser les crédits déjà achetés, créant ainsi une relation continue avec le tiers-lieu.

## Principes de fonctionnement
 

**Achat et attribution de crédits :**
- Achat de crédits : Les utilisateurs peuvent acheter des crédits de réservation via le site e-commerce.
- Attribution de crédits : Les administrateurs peuvent attribuer des crédits aux utilisateurs en fonction de leur abonnement, de leur adhésion ou d'autres critères définis.

**Utilisation des crédits :**
- Les utilisateurs peuvent utiliser leurs crédits pour réserver des services, des espaces (comme des salles de réunion), des équipements, ou tout autre type de ressource réservable.
- Lors de la réservation, le système déduit automatiquement les crédits nécessaires du compte de l'utilisateur.
- Utilisation des crédits via le site e-commerce : Lorsqu'un utilisateur souhaite réserver un service (par exemple, une salle de réunion ou un espace de travail), il peut utiliser les crédits disponibles sur son compte. Une fenêtre s'ouvre lors de l'ajout d'un service au panier, proposant d'utiliser les crédits pour le paiement. 


**Gestion des crédits :**
- Suivi des crédits : Dokos permet de suivre le solde de crédits des utilisateurs.
- Expiration des crédits : Il est recommandé de définir une date d’expiration pour les crédits afin de gérer les réservations de manière efficace et encourager leur utilisation dans un délai raisonnable.

> Exemple pratique : 

Supposons qu'un utilisateur ait acheté 4 tickets de coworking pour une demi-journée chacun. S'il souhaite réserver une journée complète, deux tickets seront automatiquement déduits de son compte.


## Les types de crédit de réservation

::tour{doctype="Booking Credit Type" demo="Mappemonde"}
Voir les types de crédit de réservation dans la démo
::
Crédits achetés seuls :
- Description: Les utilisateurs peuvent acheter un certain nombre de crédits à l'avance qu'ils pourront utiliser pour réserver des services ou des produits ultérieurement.
- Exemple: Un utilisateur achète 10 crédits à l'avance pour réserver des salles de réunion ou des équipements.

Crédits basés sur l'abonnement :
- Description: Les crédits sont accordés de manière périodique (mensuelle, annuelle, etc.) en fonction de l'abonnement de l'utilisateur. (Recurrence)
- Exemple: Un utilisateur ayant un abonnement mensuel reçoit 20 crédits chaque mois pour réserver des espaces de travail ou des activités.

Les types de crédits de réservation permettent de définir les règles de conversion et d'utilisation des crédits associés à des articles et des unités de mesure spécifiques. Cela facilite la transformation des lignes de facturation en crédits de réservation utilisables pour des services ou des produits futurs.

**Règles de conversion**

Les règles de conversion permettent de transformer un article facturé en crédits de réservation et vice-versa. Par exemple, un article vendu en heures de coworking peut être converti en crédits de réservation équivalents en fonction des règles définies.

**Couples article/Unité de mesure**
- Transformation en crédits de réservation

Le couple article/Unité de mesure permet au système de convertir automatiquement les lignes de facturation en crédits de réservation. Par exemple, la vente de 10 heures de coworking peut être transformée en 10 crédits de réservation d'une heure chacun.
- Conversion de réservation en crédits déductibles

En miroir, le système utilise un tableau de conversion pour convertir une réservation en crédits déductibles. 
Par exemple, si une réservation d'une journée entière de coworking est effectuée, elle peut être convertie en un nombre spécifique de crédits basés sur les règles définies (par exemple, 8 crédits pour une journée complète).

**Utilisation**

- Crédits achetables séparément : Les utilisateurs peuvent acheter des crédits directement sans passer par une réservation spécifique, ce qui leur permet de les utiliser ultérieurement selon leurs besoins.
-  Automatique : Lorsqu'un utilisateur fait une réservation, le système déduit automatiquement les crédits nécessaires de son solde en fonction des règles définies. 

#### Exemple 1

Mappemonde vend des **Ticket coworking** utilisables dans son **Espace de coworking**

|Vente|Conversion|
|---|---|
|Article: *Ticket coworking demi-journée*<br>Unité de mesure: *Demi-journée*<br>Crédits: 1|Article: *Espace de coworking*<br>Unité de mesure: *Demi-journée*<br>Crédits: 1|
|Article: *Ticket coworking journée*<br>Unité de mesure: *Jour*<br>Crédits: 1|Article: *Espace de coworking*<br>Unité de mesure: *Jour*<br>Crédits: 1|


#### Exemple 2

Mappemonde vend des lots de **10 Tickets coworking** utilisables dans son **Espace de coworking**

|Vente|Conversion|
|---|---|
|Article: *10 Tickets coworking demi-journée*<br>Unité de mesure: *Unité*<br>Crédits: 10|Article: *Espace de coworking*<br>Unité de mesure: *Journée*<br>Crédits: 2|
||Article: *Espace de coworking*<br>Unité de mesure: *Demi-journée*<br>Crédits: 1|


## Addition de crédits de réservation

::tour{doctype="Booking Credit" demo="Mappemonde"}
Voir les additions de crédit de réservation dans la démo
::

Les crédits de réservation peuvent être ajoutés de trois manières différentes:
1. Manuellement
2. Automatiquement à chaque validation de facture de vente
3. Automatiquement via un abonnement


### Ajout manuel de crédits de réservation

Vous pouvez ajouter des crédits de réservation manuellement en renseignant les informations suivantes:

- Date: Date de début de validité des crédits
- Date d'expiration: Si vous ne renseignez rien, la date sera calculée en fonction de la durée prévue dans le type de crédit de réservation sélectionné
  Si vide, les crédits n'auront pas de date d'expiration
- Client: Le client auquel ces crédits seront alloués
- Utilisateur: Si renseigné, les crédits ne seront utilisables que par cet utilisateur
- Type de crédits de réservation: Le type de crédit alloué
- Quantité achetée: La quantité achetée et allouée au client

### Ajout automatique à la validation de la facture de vente


Lors de la validation d'une facture, le logiciel vérifie si le couple Article/Unité de mesure présent dans chaque ligne de facturation donne droit à une allocation de crédits de réservation.  
Si une correspondance est trouvée, le nombre de crédits alloués correspondra à la quantité définie dans la ligne de facturation multipliée par le nombre de crédits indiqué dans le type de crédits de réservation correspondant.  


### Ajout automatique via un abonnement

Dans les abonnements, dans la section **Gestion du lieu**, il est possible de définir des règles d'allocation de crédits.  
Vous pouvez ajouter des lignes pour chaque type de crédits de réservations que vous souhaitez allouer.  
Indiquez une quantité ainsi qu'une règle de récurrence. Dokos allouera les crédits selon cette règle.  
La règle d'expiration permet d'écraser la règle défini dans le type de crédit de réservation.  

##### Exemples

1. Chaque abonné mensuel peut bénéficier de 4 heures de réservation de salle de réunion gratuite par semaine pendant toute la durée de son abonnement.

|Type de crédits de réservation|Quantité|Récurrence|Expiration|
|----|----|----|----|
|Ticket salle de réunion à l'heure|4|Chaque Semaine|7|

:point_right: Chaque semaine 4 unités de Ticket salle de réunion à l'heure sont alloués au client. Ces tickets expirent 7 jours plus tard, donc à la fin de la semaine.


2. Chaque abonné mensuel peut bénéficier de 10 heures de réservation de salle de réunion gratuite à utiliser pendant son mois d'abonnement.

|Type de crédits de réservation|Quantité|Récurrence|Expiration|
|----|----|----|----|
|Ticket salle de réunion à l'heure|10|Chaque Mois/A chaque période de facturation|30|

:point_right: Chaque mois (ou à chaque début de nouvelle période de facturation) 10 unités de Ticket salle de réunion à l'heure sont alloués au client. Ces tickets expirent 30 jours plus tard.


## Déduction de crédits

::tour{doctype="Booking Credit Usage" demo="Mappemonde"}
Voir les déductions de crédit de réservation dans la démo
::

La déduction de crédits peut se faire:
- Manuellement
- Via une réservation d'articles

##### Déduction manuelle

Pour déduire des crédits de réservation manuellement sélectionnez:
- L'utilisateur qui a utilisé des crédits (Optionnel)
- Le client auquel déduire les crédits
- Le type de crédits de réservation à déduire
- La quantité à déduire


##### Déduction automatique via une réservation d'articles

Lors de la création d'une réservation d'articles via le portail utilisateur (ou site E Commerce), la case **Déduire des crédits de réservation** est cochée lorsque les utilisateurs décident d'utiliser leurs crédits de réservation.  
Cela déclenche la création automatique d'une déduction de crédits de réservation pour le couple Article/Unité de mesure sélectionnés.  


## Règles de crédits de réservation

<details>
<summary>Cet article est valable pour les anciennes versions de Dokos</summary>


::callout
Jusqu'à la version 3.27, les crédits de réservations pouvaient être ajoutés/déduits via des règles de crédit de réservation.  
La conversion entre un article de vente et un article réservable se faisait via des Conversions de crédits de réservation
::

Bien qu'il soit possible d'ajouter et de déduire des crédits manuellement, ces opérations sont fastidieuses et peuvent prendre beaucoup de temps.  
Il est donc possible de créer des règles qui ajouteront ou déduiront automatiquement ces crédits en fonction des actions des utilisateurs.  

### Règles d'addition

Une règle d'addition va lire un document généré par l'action d'un utilisateur et ajouter les crédits correspondant si celui-ci répond à certains critères.  


> Nous souhaitons que des crédits soient automatiquement attribués à un client à chaque fois qu'il achète l'article "Coworking Ponctuel".
> 
> Nous allons donc créer une règle d'addition de crédits de réservation avec les critères suivants:
> 
> - Cette règle sera uniquement applicable pour un article, en l'occurence l'article Coworking Ponctuel.
> - L'élément déclencheur sera la validation d'une facture de vente.
> - Nous définirons également que nous souhaitons lire les informations concernant la quantité, l'unité de mesure et l'article dans la table enfant "Articles".
> - Nous pourrions également ajouter une condition, comme par exemple que cette règle ne concerne que les client appartenant au groupe de clients "Coworkers".
> - Nous définirons que ces crédits expirent au bout de 6 mois.
> - Puis nous établirons une correpondance entre certaines informations nécessaire pour le fonctionnement de la règle et les champs correspondants dans la facture de vente (et le tableau d'articles).
> 

Cette règle donnera le document suivant:

- **Type de règle**: Addition de crédits de réservation
- **Applicable uniquement pour**: Article
- **Document**: Coworking ponctuel

- **Document déclencheur**: Facture de vente
- **Action déclencheuse**: A la validation
- **Utiliser une table enfant pour l'article, l'unité de mesure et la quantité**: Oui
- **Table enfant**: Articles
- **Conditions**: doc.customer_group == "Coworkers"

- **Règle d'expiration**: Ajouter X Mois
- **Délai d'expiration**: 6

- **Champ Client**: Client
- **Champ contenant l'utilisateur**: _Vide_ (Les crédits seront attribués au client et non pas spécifiquement à un utilisateur lié à ce client)
- **Champ Unité de mesure**: Unité de mesure (Champ de la ligne d'articles)
- **Champ Article**: Article (Champ de la ligne d'articles)
- **Champ Date**: Date
- **Champ Quantité**: Quantité (Champ de la ligne d'articles)


::callout{icon="i-heroicons-light-bulb" color="teal"}
Un client achète 10 Heures de l'article Coworking ponctuel. La règle ci-dessus lui ajoutera automatiquement 10 Heures associées à l'article coworking ponctuel à la validation de la facture correspondante.
::


#### Règles personnalisées

Dans certains cas, les unités de mesure et l'aticle à ajouter au crédit du client ne correspondent pas à ceux du document de référence. On peut alors créer des correspondances grâce aux règles personnalisées.

Ces règles permettent de définir l'unité de mesure source - celle du document de référence -, la quantité cible pour une unité de quantité source et son unité de mesure cible - celle du crédit de réservation -.


> On souhaite facture un abonnement mensuel correspondant à 10 journées de coworking.
> Dans ce cas on créera une règle du type:
> |Unité de mesure source|Quantité cible|Unité de mesure cible|
> |----------------------|--------------|---------------------|
> |Mois|10|Jour|



### Règles de déduction

Une règle de déduction va lire un document généré par l'action d'un utilisateur et déduire les crédits correspondant si celui-ci répond à certains critères.
Si les principes sont similaires aux règles d'addition de crédits, les règles de déduction ont quelques différences:

1. Elles ont une date de validité, qui peut servir notamment à déduire des crédits associés à des réservations faites dans le passé.
2. Il est possible d'arrondir l'usage à l'unité supérieure ou inférieure (Si l'utilisateur a consommé 2.5 heures, on peut déduire 2 heures ou 3 heures)
3. Les crédits peuvent être déduits:
	- Selon l'unité de mesure la plus proche de la consommation réelle
	Ex. Si l'utilisateur a acheté 5 heures, puis 2 jours de coworking et viens passer une journée dans le lieu, on lui déduira une journée

	- Selon la règle du premier entré/premier sorti
	Ex. Si l'utilisateur a acheté 10 journées, puis 10 heures de coworking et passe 2 heures dans le lieu, on lui déduira une journée

	- Selon des règles personnalisées

#### Les règles personnalisées

Les règles de déduction personnalisées permettent de s'affranchir des règles de déduction par défaut, basées sur la consommation exacte de minutes de réservations.  

Il est ainsi possible de mettre en place des scénarios comme par exemple:

- Si l'utilisateur reste moins de 4 heures, on lui déduit le nombre d'heures consommées
- Si l'utilisateur reste entre 4 et 5 heures, on lui déduit une demi-journée
- Si l'utilisateur reste entre 6 et 7 heures, on lui déduit une demi-journée + les heures au delà de 5 heures
- Si l'utilisateur reste plus de 7 heures, on lui déduit 1 journée

Vous pouvez ainsi définir deux composantes:
1. Une durée (mins)
2. Un intervalle de temps (mins)

Le temps consommé est calculé en minutes.
Si cette durée est contenue dans un des intervalles de temps, le système déduira l'unité de mesure correspondant à cet intervalle, puis cherchera un autre intervalle ou une durée correspond au temps restant.

Pour configurer le cas de figure ci-dessus, il faut donc entrer les informations suivantes dans le tableau:

|Durée|Intervalle minimum|Intervalle maximum|Unité de mesure|Quantité de crédit|
|-----|------------------|------------------|---------------|------------------|
|60|||Heure|1|
||240|300|Demi-journée|1|
||480|960|Jour|1|


Afin de déterminer quel article doit être déduit, Dokos permet de configurer des conversion de réservation de crédits.

### Conversion de réservation de crédits

Les conversion de réservation de crédits permettent d'indiquer à Dokos quels articles peuvent être convertis lors des déductions de crédit.  

Prenons par exemple un lieu qui loue 4 salles: 2 x 30m2 et 2 x 50m2.
Ce tiers lieu vendra 2 types de tickets: "Ticket petite salle" et "Ticket grande salle".

Dans ce cas les articles correspondant aux deux salles de 30m2 pourront être convertis en "Ticket petite salle" et les articles correspondant aux deux salles de 60m2 pourront être convertis en "Ticket grande salle".

Ces documents permettront également au système d'effectuer une conversion automatique lors des réservations sur le site web.
</details>